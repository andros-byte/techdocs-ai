import streamlit as st
import openai

# 1. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
st.set_page_config(
    page_title="AI Technical Guide",
    page_icon="ü§ñ",
    layout="centered"
)

# 2. –¢–≤–æ—ó –¥–∞–Ω—ñ (OpenAI —Ç–∞ PayPal)
# –í—Å—Ç–∞–≤ —Å–≤—ñ–π API –∫–ª—é—á –∑–∞–º—ñ—Å—Ç—å —Ç–µ–∫—Å—Ç—É –Ω–∏–∂—á–µ
openai.api_key = "–¢–í–Ü–ô_OPENAI_API_KEY" 
MY_PAYPAL_EMAIL = "np.kremenchuk.sb@gmail.com"

# 3. –ì–æ–ª–æ–≤–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
st.title("ü§ñ AI Technical Guide Assistant")
st.subheader("–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω—ñ —Ç–µ—Ö–Ω—ñ—á–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó")

# --- –ö–†–û–ö 1: –í–í–ï–î–ï–ù–ù–Ø –ó–ê–ü–ò–¢–£ ---
st.write("### 1. –û–ø–∏—à—ñ—Ç—å –≤–∞—à—É —Å–∏—Ç—É–∞—Ü—ñ—é")
user_query = st.text_area(
    "–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ —Ç–µ—Ö–Ω—ñ—á–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è –∞–±–æ –ø—Ä–æ–±–ª–µ–º—É:", 
    placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ø–∫ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é –≤ –∞–∫–∞—É–Ω—Ç—ñ PayPal –∞–±–æ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ–º–∏–ª–∫—É –≤—Ö–æ–¥—É...",
    height=150
)

# --- –ö–†–û–ö 2: –û–ü–õ–ê–¢–ê –¢–ê –ì–ï–ù–ï–†–ê–¶–Ü–Ø (–ó'—è–≤–ª—è—é—Ç—å—Å—è –ø—ñ—Å–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É) ---
if user_query:
    st.write("---")
    st.write("### 2. –û—Ç—Ä–∏–º–∞–π—Ç–µ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω—É —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—é")
    st.info("–î–ª—è —Ñ–æ—Ä–º—É–≤–∞–Ω–Ω—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –≤–∞—à –∑–∞–ø–∏—Ç, –±—É–¥—å –ª–∞—Å–∫–∞, –∑–¥—ñ–π—Å–Ω—ñ—Ç—å –æ–ø–ª–∞—Ç—É.")
    st.write("–í–∞—Ä—Ç—ñ—Å—Ç—å –ø–æ—Å–ª—É–≥–∏: **$1.99**")

    # –§–æ—Ä–º—É–≤–∞–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è PayPal (–∫–ª—ñ—î–Ω—Ç –ø–æ–±–∞—á–∏—Ç—å —Å–≤—ñ–π –∑–∞–ø–∏—Ç —É –∫–≤–∏—Ç–∞–Ω—Ü—ñ—ó)
    item_description = f"Technical Recommendation: {user_query[:40]}..."
    payment_url = (
        f"https://www.paypal.com/cgi-bin/webscr?cmd=_xclick"
        f"&business={MY_PAYPAL_EMAIL}"
        f"&item_name={item_description}"
        f"&amount=1.99"
        f"&currency_code=USD"
    )

    # –ü–†–û–§–ï–°–Ü–ô–ù–ê –°–ò–ù–Ø –ö–ù–û–ü–ö–ê (–∑–∞–º—ñ—Å—Ç—å –∂–æ–≤—Ç–æ—ó)
    st.markdown(f'''
        <a href="{payment_url}" target="_blank" style="text-decoration: none;">
            <div style="
                display: inline-block; 
                padding: 14px 28px; 
                color: #ffffff; 
                background-color: #0070ba; 
                border-radius: 8px; 
                font-weight: bold; 
                font-size: 18px;
                text-align: center; 
                box-shadow: 0px 4px 10px rgba(0,0,0,0.1);
                border: none;
            ">
                –°–ø–ª–∞—Ç–∏—Ç–∏ $1.99 —á–µ—Ä–µ–∑ PayPal
            </div>
        </a>
    ''', unsafe_allow_html=True)

    st.write("")
    st.write("---")
    
    # –ö–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –®–Ü –ø—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏
    if st.button("–û—Ç—Ä–∏–º–∞—Ç–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—é (—è –≤–∂–µ –æ–ø–ª–∞—Ç–∏–≤)"):
        with st.spinner("–§–æ—Ä–º—É—î–º–æ –≤–∞—à—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é..."):
            try:
                # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ç–≤—ñ–π –±–∞–ª–∞–Ω—Å $4.88 –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
                response = openai.ChatCompletion.create(
                    model="gpt-3.5-turbo",
                    messages=[
                        {"role": "system", "content": "–¢–∏ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π —Ç–µ—Ö–Ω—ñ—á–Ω–∏–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç. –¢–≤–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –º–∞—é—Ç—å –±—É—Ç–∏ —á—ñ—Ç–∫–∏–º–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–º–∏ —Ç–∞ –±–∞–∑—É–≤–∞—Ç–∏—Å—è –Ω–∞ –æ—Ñ—ñ—Ü—ñ–π–Ω–∏—Ö –¥–∞–Ω–∏—Ö."},
                        {"role": "user", "content": user_query}
                    ]
                )
                
                st.write("---")
                st.success("‚úÖ –í–∞—à–∞ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è –≥–æ—Ç–æ–≤–∞:")
                st.write(response.choices[0].message.content)
                
                # –°–≤—è—Ç–∫–æ–≤—ñ –∫—É–ª—å–∫–∏ –¥–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è
                st.balloons()
                
            except Exception as e:
                st.error(f"–í–∏–Ω–∏–∫–ª–∞ —Ç–µ—Ö–Ω—ñ—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞: {e}")
                st.info("–ë—É–¥—å –ª–∞—Å–∫–∞, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ API Key –∞–±–æ –∑–∞–ª–∏—à–æ–∫ –Ω–∞ –±–∞–ª–∞–Ω—Å—ñ ($4.88).")

else:
    # –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫—â–æ –ø–æ–ª–µ –≤–≤–æ–¥—É –ø—É—Å—Ç–µ
    st.warning("–ë—É–¥—å –ª–∞—Å–∫–∞, —Å–ø–æ—á–∞—Ç–∫—É –æ–ø–∏—à—ñ—Ç—å –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É –≤–∏—â–µ, —â–æ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ä–æ–∑–¥—ñ–ª –æ–ø–ª–∞—Ç–∏.")

# 4. –§—É—Ç–µ—Ä —Å–∞–π—Ç—É
st.markdown("---")
st.caption("¬© 2026 TechDocs Pro ‚Äî –ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∞ —Ç–µ—Ö–Ω—ñ—á–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞")
